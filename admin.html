<!DOCTYPE html>
<html>
<head>
  <title>Admin – Meccs hozzáadása</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import {
      getFirestore, collection, addDoc, Timestamp
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
  apiKey: "AIzaSyC2xpMW1xgaWIdI2JoEhK23vkC0FTF2PKc",
  authDomain: "tippliga-4b3af.firebaseapp.com",
  projectId: "tippliga-4b3af",
  storageBucket: "tippliga-4b3af.firebasestorage.app",
  messagingSenderId: "720359845241",
  appId: "1:720359845241:web:d3d6edcac6b43ebff053a8"
};

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const adminEmail = "krisz@krisz.com";

    onAuthStateChanged(auth, (user) => {
      if (!user || user.email !== adminEmail) {
        document.body.innerHTML = "<h2>⛔ Nincs jogosultságod az admin felülethez.</h2>";
        return;
      }

      const form = document.createElement("form");

      form.innerHTML = `
        <h1>Meccs hozzáadása</h1>
        <label>Hazai csapat: <input type="text" id="homeTeam" required></label><br><br>
        <label>Vendég csapat: <input type="text" id="awayTeam" required></label><br><br>
        <label>Kezdés időpontja: <input type="datetime-local" id="startTime" required></label><br><br>
        <label>Forduló ID (pl. round1): <input type="text" id="roundId" required></label><br><br>
        <label>Odds 1: <input type="number" step="0.01" id="odds1" required></label><br>
        <label>Odds X: <input type="number" step="0.01" id="oddsX" required></label><br>
        <label>Odds 2: <input type="number" step="0.01" id="odds2" required></label><br><br>
        <button type="submit">Meccs mentése</button>
      `;

      form.onsubmit = async (e) => {
        e.preventDefault();

        const homeTeam = document.getElementById("homeTeam").value;
        const awayTeam = document.getElementById("awayTeam").value;
        const startTimeInput = document.getElementById("startTime").value;
        const roundId = document.getElementById("roundId").value;
        const odds1 = parseFloat(document.getElementById("odds1").value);
        const oddsX = parseFloat(document.getElementById("oddsX").value);
        const odds2 = parseFloat(document.getElementById("odds2").value);

        const startTime = Timestamp.fromDate(new Date(startTimeInput));

        await addDoc(collection(db, "matches"), {
          homeTeam,
          awayTeam,
          startTime,
          roundId,
          odds: {
            "1": odds1,
            "X": oddsX,
            "2": odds2
          }
        });

        alert("✅ Meccs sikeresen mentve!");
        form.reset();
      };

      document.body.appendChild(form);
    });
  </script>
</head>
<body>
</body>
</html>
