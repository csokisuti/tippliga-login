import React, { useEffect, useState } from 'react'

export default function EntryMock(){
  const [loading,setLoading]=useState(true)
  const [authed,setAuthed]=useState(false)
  const [admin,setAdmin]=useState(false)
  const [lastLeague,setLastLeague]=useState(null)
  const [email,setEmail]=useState("")
  const [password,setPassword]=useState("")
  const [remember,setRemember]=useState(true)
  useEffect(()=>{ const t=setTimeout(()=>setLoading(false),800); return()=>clearTimeout(t)},[])

  const LEAGUES={
    nb1:{ code:"nb1", name:"NB I TippLiga", emoji:"üá≠üá∫", href:"#nb1", logo:"fizz.png" },
    ucl:{ code:"ucl", name:"BL TippLiga", emoji:"‚≠ê", href:"#ucl", logo:"ucl.png" }
  }

  function Header(){
    return (
      <div className="flex items-center justify-between mb-4">
        <div className="flex items-center gap-3">
          <div className="w-11 h-11 rounded-xl bg-[#111a30] border border-[#1f2a44] grid place-items-center font-extrabold">TL</div>
          <div>
            <h1 className="m-0 text-lg">TippLiga ‚Äì k√∂z√∂s bel√©p√©s</h1>
            <p className="m-0 text-sm text-slate-400">NB I √©s BL egy helyen</p>
          </div>
        </div>
        <div className="text-slate-400 text-sm">{authed?"Bejelentkezve":"Vend√©g m√≥d"}</div>
      </div>
    )
  }

  function LeagueCards(){
    return (
      <div className="grid grid-cols-2 gap-3 mt-3 max-[520px]:grid-cols-1">
        {Object.keys(LEAGUES).map(k=>{
          const L=LEAGUES[k]
          return (
            <a key={k} href={L.href} onClick={()=>setLastLeague(L.code)} className="flex flex-col gap-3 p-4 border border-[#1f2a44] rounded-xl bg-[#0c152b] hover:-translate-y-0.5 hover:border-[#2a3a66] transition">
              <div className="flex items-center gap-3">
                <img src={L.logo} alt={`${L.name} log√≥`} className="h-8 w-auto rounded bg-white/90 p-1 border border-[#1f2a44]"/>
                <span className="inline-flex items-center gap-2 text-xs text-slate-300 bg-[#0b142a] border border-[#1f2a44] rounded-full px-3 py-1">{L.emoji} {L.name}</span>
              </div>
              <span className="text-slate-400 text-sm">Bel√©p√©s a {L.name} fel√ºletre</span>
            </a>
          )
        })}
      </div>
    )
  }

  function Panel({title,children}){
    return (
      <div className="bg-gradient-to-b from-[#0e1730] to-[#111a33] border border-[#1f2a44] rounded-xl p-4">
        <h2 className="m-0 mb-2 text-base">{title}</h2>
        {children}
      </div>
    )
  }

  function Button({children,variant="default",onClick,href}){
    const base="px-4 py-2 rounded-lg font-semibold border text-sm"
    const cls={
      default: base+" bg-[#0f1a34] border-[#1f2a44] hover:border-[#2a3a66]",
      accent: base+" bg-blue-600 border-blue-600 hover:brightness-110",
      green: base+" bg-emerald-500 border-emerald-500 hover:brightness-110"
    }[variant]
    const Comp = href? 'a':'button'
    return <Comp href={href} onClick={onClick} className={cls}>{children}</Comp>
  }

  return (
    <div className="min-h-screen text-slate-100" style={{background:"linear-gradient(180deg,#0a0f1c 0%,#0b1220 100%)"}}>
      <div className="min-h-screen flex items-center justify-center p-7">
        <div className="w-full max-w-[980px] bg-[#0f172a]/85 backdrop-blur border border-[#1f2a44] rounded-2xl shadow-[0_8px_30px_rgba(0,0,0,.35)] p-6">
          <Header/>

          {loading && (
            <div className="grid place-items-center py-8">
              <div className="w-8 h-8 rounded-full border-2 border-[#2a3a66] border-t-blue-500 animate-spin"/>
            </div>
          )}

          {!loading && (
            <div className="grid grid-cols-[1.1fr_.9fr] gap-4 max-[900px]:grid-cols-1">
              {authed? (
                <>
                  <Panel title={`√údv, ${"krisztian@example.com"}`}>
                    <p className="text-slate-400 text-sm">V√°lassz lig√°t vagy folytasd az utols√≥val.</p>
                    <div className="flex flex-wrap gap-2 my-3">
                      {lastLeague && (
                        <Button variant="green" href={"#"+lastLeague}>
                          Gyors bel√©p√©s: {lastLeague==="nb1"?LEAGUES.nb1.name:LEAGUES.ucl.name}
                        </Button>
                      )}
                      <Button onClick={()=>{setAuthed(false); setAdmin(false)}}>Kijelentkez√©s</Button>
                    </div>
                    <LeagueCards/>
                  </Panel>

                  <Panel title="Admin k√∂zpont">
                    {admin? (
                      <div className="flex gap-2 flex-wrap">
                        <Button href="#admin-nb1">NB I admin</Button>
                        <Button href="#admin-ucl">BL admin</Button>
                      </div>
                    ) : (
                      <p className="text-slate-400 text-sm">Csak admin jogosults√°ggal l√°that√≥.</p>
                    )}
                  </Panel>
                </>
              ) : (
                <>
                  <Panel title="Bejelentkez√©s">
                    <div className="flex flex-col gap-2 my-2">
                      <input value={email} onChange={e=>setEmail(e.target.value)} placeholder="E-mail" className="w-full px-3 py-3 rounded-lg bg-[#0b142a] border border-[#1f2a44] outline-none"/>
                      <input type="password" value={password} onChange={e=>setPassword(e.target.value)} placeholder="Jelsz√≥" className="w-full px-3 py-3 rounded-lg bg-[#0b142a] border border-[#1f2a44] outline-none"/>
                    </div>
                    <div className="flex items-center justify-between gap-3">
                      <label className="flex items-center gap-2 text-slate-300 text-sm">
                        <input type="checkbox" checked={remember} onChange={()=>setRemember(!remember)} />
                        Eml√©kezz r√°m ezen az eszk√∂z√∂n
                      </label>
                      <Button variant="accent" onClick={()=>{setAuthed(true)}}>Bel√©p√©s</Button>
                    </div>
                    <div className="mt-3">
                      <Button onClick={()=>{}}>
                        Elfelejtett jelsz√≥
                      </Button>
                    </div>
                  </Panel>

                  <Panel title="Mi ez az oldal?">
                    <p className="text-slate-400 text-sm">Egy k√∂z√∂s kapu az NB I √©s a BL TippLiga fel√ºleteidhez. Bejelentkez√©s ut√°n v√°laszthatsz lig√°t, √©s elmentj√ºk az utols√≥ v√°laszt√°sodat a gyors bel√©p√©shez.</p>
                    <LeagueCards/>
                  </Panel>
                </>
              )}
            </div>
          )}

          <div className="mt-6 border-t border-[#1f2a44] pt-4 text-xs text-slate-400">
            <div className="flex items-center gap-2 flex-wrap">
              <span className="font-semibold">Mock kapcsol√≥k:</span>
              <button className="px-3 py-1 rounded bg-[#0f1a34] border border-[#1f2a44] hover:border-[#2a3a66]" onClick={()=>setAuthed(v=>!v)}>{authed?"√Åtv√°lt√°s vend√©g m√≥dra":"√Åtv√°lt√°s bejelentkezett m√≥dra"}</button>
              <button className="px-3 py-1 rounded bg-[#0f1a34] border border-[#1f2a44] hover:border-[#2a3a66]" onClick={()=>setAdmin(v=>!v)} disabled={!authed} style={{opacity:authed?1:.5}}>{admin?"Admin kikapcsol√°sa":"Admin bekapcsol√°sa"}</button>
              <button className="px-3 py-1 rounded bg-[#0f1a34] border border-[#1f2a44] hover:border-[#2a3a66]" onClick={()=>setLastLeague(lastLeague?null:"nb1")} disabled={!authed} style={{opacity:authed?1:.5}}>{lastLeague?"Gyors bel√©p√©s elt√ºntet√©se":"Gyors bel√©p√©s be√°ll√≠t√°sa (NB I)"}</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}

function quickLabel(last){
  if(!last) return null
  if(last==="nb1") return "Gyors bel√©p√©s: NB I TippLiga"
  if(last==="ucl") return "Gyors bel√©p√©s: BL TippLiga"
  return null
}

try{
  console.assert(quickLabel("nb1")==="Gyors bel√©p√©s: NB I TippLiga","nb1 quick label hib√°s")
  console.assert(quickLabel("ucl")==="Gyors bel√©p√©s: BL TippLiga","ucl quick label hib√°s")
  console.assert(quickLabel(null)===null,"null quick label hib√°s")
  console.log("EntryMock be√©p√≠tett tesztek: OK")
}catch(e){
  console.error("EntryMock tesztek hib√°ja",e)
}
